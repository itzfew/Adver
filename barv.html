<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Top 10 YouTube Channels</title>
  <!-- Font Awesome CDN for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    html, body {
      height: 100%; /* Ensure full height of the viewport */
      margin: 0;    /* Remove default margin */
      overflow: hidden; /* Prevent body from scrolling */
    }

    body {
      display: flex;
      justify-content: flex-start;
      align-items: flex-end;
      background-color: #f7f9fc;
      flex-direction: column;
      position: relative;
    }

    .container {
      display: flex;
      flex-direction: row; /* Arrange country items horizontally */
      justify-content: flex-start;
      align-items: flex-end; /* Align items at the bottom */
      width: 100%;
      height: 100vh; /* Full height of the viewport */
      padding: 20px;
      overflow-x: auto; /* Allow horizontal scrolling */
      box-sizing: border-box; /* Prevent padding from affecting width */
      margin-top: 60px; /* Leave space for the header */
    }

    .country-list {
      display: flex;
      justify-content: flex-start;
      align-items: flex-end;
      flex-direction: row; /* Keep all countries in a horizontal line */
      height: 100%; /* Full height for the list */
      padding-right: 20px; /* Prevent last item from being cut off */
      overflow-x: auto; /* Allow scrolling if country list overflows horizontally */
    }

    .country-item {
      display: flex;
      flex-direction: column; /* Stack elements vertically */
      justify-content: flex-end; /* Align to the bottom */
      align-items: center;
      margin-right: 2%; /* Space between country items */
      position: relative;
      height: 80%; /* Limit the height of the country item */
      width: 100px; /* Set a fixed width for the item */
      opacity: 0; /* Initially hidden */
      transition: opacity 1s ease-in-out;
    }

    .bar {
      width: 100px; /* Fixed width of the vertical bar */
      height: 0%; /* Initially set height to 0% */
      position: relative;
      bottom: 0; /* Position bar at the bottom of its container */
      border-radius: 5px;
      background-color: #3498db; /* Default color */
      transition: height 1s ease-in-out; /* Smooth transition for bar height */
      margin: 0 10px; /* Add horizontal margin for spacing */
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .country-name {
      position: absolute; /* Absolute positioning to center the name */
      color: white;
      font-size: 12px; /* Smaller font size */
      font-weight: bold;
      text-align: center;
      transform: translateY(0%); /* Center vertically */
      z-index: 2; /* Ensure the text stays on top of the bar */
      letter-spacing: 1px;
    }

    .population-label {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-weight: bold;
      font: italic small-caps bold 22px/30px Georgia, serif;
      color: white;
      font-size: 16px;
    }

    .country-flag {
      position: absolute;
      top: -101px; /* Position flag above the bar */
      width: 100px; /* Set flag width */
      height: 100px; /* Set flag height */
      object-fit: contain;
    }

    /* Additional styles to handle responsiveness */
    @media screen and (max-width: 768px) {
      .country-name {
        font-size: 14px; /* Smaller font size for smaller screens */
      }
      .country-item {
        width: 100px; /* Reduce width for smaller screens */
      }
      .country-flag {
        width: 100px; /* Reduce flag size for smaller screens */
        height: 100px;
      }
    }

    /* Buttons to start */
    .control-buttons {
      position: fixed;
      top: 20px;
      right: 5px;
      z-index: 20;
    }

    .control-buttons button {
      
      color: black;
      padding: 5px 10px;
      border: solid 1px black ;
      border-radius: 5px;
      margin: 5px;
      cursor: pointer;
      font-size: 20px;
    }

    .control-buttons button:disabled {
      background-color: #ddd;
      cursor: not-allowed;
    }

    /* File input styles */
    .file-inputs {
      position: fixed;
      top: 5px;
      right: 10px;
      z-index: 20;
    }

    .file-inputs input {
      margin: 5px;
    }

    /* Full-screen video styling */
    #background-video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: -1; /* Place video behind other elements */
      display: none; /* Initially hide the video */
    }
  </style>
</head>
<body>

  <!-- Buttons for controlling the animation -->
  <div class="control-buttons">
    <button id="start-button"><i class="fas fa-play"></i> Start</button>
  </div>

  <!-- File inputs for uploading background image, audio, or video -->
  <div class="file-inputs">
    <input type="file" id="image-upload" accept="image/*" />
    <input type="file" id="audio-upload" accept="audio/*" />
    <input type="file" id="video-upload" accept="video/*" />
  </div>

  <div class="container">
    <div class="country-list" id="country-list">
      <!-- Dynamic Country Items will be added here -->
    </div>
  </div>

  <script>
    let animationInProgress = false;
    let animationTimeouts = [];

    // URL for the JSON data
    const jsonUrl = 'https://raw.githubusercontent.com/itzfew/Adver/refs/heads/main/bar.json';

    // Function to update the bar with animation
    function updateBar(country, population, maxPopulation) {
      return new Promise(resolve => {
        const bar = document.getElementById(`${country.name.toLowerCase()}-bar`);
        const populationLabel = `${population.toFixed(2)}`;

        // Calculate bar height as a proportion of the max population (max height is 80%)
        const barHeight = Math.min(80, (population / maxPopulation) * 80);

        // Dynamically set transition duration based on the height (percentage) of the bar
        const duration = (barHeight / 100) * 5;

        bar.style.transitionDuration = `${duration}s`;
        setTimeout(() => {
          bar.style.height = `${barHeight}%`;
          bar.style.backgroundColor = country.color;
          bar.querySelector('.population-label').textContent = populationLabel;
          document.getElementById(`${country.name.toLowerCase()}-item`).style.opacity = 1;

          bar.scrollIntoView({
            behavior: 'smooth',
            block: 'center',
          });

          setTimeout(resolve, duration * 1000);
        }, 100);
      });
    }

    // Function to fetch population data and animate the bars
    function fetchPopulationData() {
      fetch(jsonUrl)
        .then(response => {
          if (!response.ok) throw new Error('Network response was not ok');
          return response.json();
        })
        .then(data => {
          const countries = data.countries;
          const maxPopulation = Math.max(...countries.map(country => country.population));
          createCountryList(countries);
          animateBars(countries, maxPopulation);
        })
        .catch(error => {
          console.error('Error fetching population data:', error);
          alert('Error loading population data.');
        });
    }

    // Function to dynamically create country list items
    function createCountryList(countries) {
      const countryListContainer = document.getElementById('country-list');
      countries.forEach(country => {
        const countryItem = document.createElement('div');
        countryItem.classList.add('country-item');
        countryItem.id = `${country.name.toLowerCase()}-item`;

        const bar = document.createElement('div');
        bar.classList.add('bar');
        bar.id = `${country.name.toLowerCase()}-bar`;

        const populationLabel = document.createElement('div');
        populationLabel.classList.add('population-label');
        populationLabel.id = `${country.name.toLowerCase()}-pop`;
        populationLabel.textContent = `${country.population.toFixed(2)}`;

        const countryFlag = document.createElement('img');
        countryFlag.classList.add('country-flag');
        countryFlag.src = country.flagImage;

        const countryName = document.createElement('div');
        countryName.classList.add('country-name');
        countryName.textContent = country.name;

        bar.appendChild(populationLabel);
        bar.appendChild(countryName);
        bar.appendChild(countryFlag);
        countryItem.appendChild(bar);
        countryItem.appendChild(countryName);
        countryListContainer.appendChild(countryItem);
      });
    }

    // Function to animate bars
    function animateBars(countries, maxPopulation) {
      countries.sort((a, b) => a.population - b.population);

      let animationChain = Promise.resolve();
      countries.forEach(country => {
        if (!animationInProgress) return;
        animationChain = animationChain.then(() => updateBar(country, country.population, maxPopulation));
      });
    }

    // Start animation when button is clicked
    document.getElementById('start-button').addEventListener('click', () => {
      animationInProgress = true;
      fetchPopulationData();
      document.getElementById('start-button').disabled = true;

      // Play background video if available
      const video = document.getElementById('background-video');
      if (video) {
        video.style.display = 'block';  // Make sure the video is visible
        video.play();  // Start playing the video
      }
    });

    // Handle file uploads
    document.getElementById('image-upload').addEventListener('change', event => {
      const file = event.target.files[0];
      if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = function (e) {
          document.body.style.backgroundImage = `url(${e.target.result})`;
          document.body.style.backgroundSize = 'cover';
          document.body.style.backgroundPosition = 'center';
        };
        reader.readAsDataURL(file);
      }
    });

    document.getElementById('audio-upload').addEventListener('change', event => {
      const file = event.target.files[0];
      if (file && file.type.startsWith('audio/')) {
        const audio = new Audio(URL.createObjectURL(file));
        audio.loop = true;
        audio.play();
      }
    });

    document.getElementById('video-upload').addEventListener('change', event => {
      const file = event.target.files[0];
      if (file && file.type.startsWith('video/')) {
        const video = document.createElement('video');
        video.id = 'background-video';
        video.src = URL.createObjectURL(file);
        video.autoplay = false;
        video.loop = true;
        video.muted = true;
        document.body.appendChild(video);
      }
    });
  </script>
</body>
</html>
